corr <- function(directory, threshold = 0) {	## Copyright George W. Frink III	## Written by George W. Frink III 	## Contact: frink@southernconnections.net        ## 'directory' is a character vector of length 1 indicating        ## the location of the CSV files        ## 'threshold' is a numeric vector of length 1 indicating the        ## number of completely observed observations (on all        ## variables) required to compute the correlation between        ## nitrate and sulfate; the default is 0	completeCasesCorrelations <- c() # Blank table	SN <- c()        ## Return a numeric vector of correlations		fileNames <- list.files(path = directory, pattern = NULL, all.files = FALSE, full.names = FALSE, recursive = FALSE, include.dirs = FALSE)				for( i in 1:length(fileNames)) { 							fileName <- paste( directory, "/", fileNames[i], sep = "" )			tempTbl <- read.csv(fileName,  sep = ",", quote = "\"",header = TRUE, dec = ".", fill = TRUE, comment.char = "#")			completeCasesCount <- sum(complete.cases(tempTbl))			if (completeCasesCount >= threshold) {				completeCasesTable <- tempTbl[complete.cases(tempTbl),]					SN <- cor(completeCasesTable$sulfate, completeCasesTable$nitrate)				SN <- round(SN, digits = 5)				completeCasesCorrelations <- c(completeCasesCorrelations, SN )				    }			}			return( completeCasesCorrelations )		}